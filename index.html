<!DOCTYPE html>
<html lang="fr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Gestion des Ventes</title>
    <link rel="stylesheet" href="styles.css">
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">
    <link href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.11.0/font/bootstrap-icons.css" rel="stylesheet">
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/flatpickr/dist/flatpickr.min.css">
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/xlsx/0.18.5/xlsx.full.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/chartjs-plugin-datalabels@2.0.0"></script>
    <script src="https://cdn.jsdelivr.net/npm/flatpickr"></script>
    <script src="https://cdn.jsdelivr.net/npm/flatpickr/dist/l10n/fr.js"></script>
    <style>
        /* Container and layout fixes */
        .navbar-container, .main-content {
            padding-left: 0;
            padding-right: 0;
        }
        .container-fluid {
            padding-left: 12px;
            padding-right: 12px;
        }
        .content {
            padding-left: 0;
            padding-right: 0;
            margin-top: 1rem !important;
        }
        /* Remove unnecessary margins that cause misalignment */
        .row {
            margin-left: 0;
            margin-right: 0;
        }
        
        /* Card styling */
        .card {
            border-radius: 0;
            margin-bottom: 1rem;
        }
        .card-header {
            padding-left: 12px;
            padding-right: 12px;
        }
        
        /* Table styling */
        .table-responsive {
            margin-top: 0.5rem;
        }
        .table {
            margin-bottom: 0;
        }
        .table th, .table td {
            padding-left: 12px;
            padding-right: 12px;
        }
        
        /* Section-specific fixes */
        #reconciliation-section .card-body,
        #saisie-section .card-body,
        #precommande-section .card-body,
        #visualisation-section .card-body,
        #import-section .card-body,
        #stock-inventaire-section .card-body,
        #copier-stock-section .card-body,
        #stock-alerte-section .card-body,
        #cash-payment-section .card-body {
            padding-left: 12px;
            padding-right: 12px;
        }
        
        /* Ensure reconciliation sections don't appear in Saisie tab */
        #saisie-section:not([style*="none"]) ~ #reconciliation-section,
        #saisie-section:not([style*="none"]) ~ #reconciliation-mois-section {
            display: none !important;
        }
        .status-indicator {
            display: inline-flex;
            justify-content: center;
            align-items: center;
            width: 2rem;
            height: 2rem;
            border-radius: 50%;
        }
        .status-indicator i {
            font-size: 1.5rem;
        }
        .status-indicator.green {
            background-color: rgba(25, 135, 84, 0.1);
        }
        .status-indicator.yellow {
            background-color: rgba(255, 193, 7, 0.1);
        }
        .status-indicator.red {
            background-color: rgba(220, 53, 69, 0.1);
        }
        /* Threshold slider styles */
        .performance-slider-container {
            padding: 25px 10px 10px;
            position: relative;
            margin-bottom: 10px;
        }
        
        /* Styles pour les ventes provenant de pré-commandes */
        .vente-precommande {
            background-color: #e3f2fd !important;
            border-left: 4px solid #2196f3 !important;
        }

        /* Styles pour les statuts des pré-commandes */
        .statut-ouvert {
            background-color: #d4edda !important;
            color: #155724 !important;
            border-left: 4px solid #28a745 !important;
        }
        
        .statut-convertie {
            background-color: #f8f9fa !important;
            color: #6c757d !important;
            border-left: 4px solid #6c757d !important;
        }
        
        .statut-annulee {
            background-color: #f8d7da !important;
            color: #721c24 !important;
            border-left: 4px solid #dc3545 !important;
        }
        
        .statut-archivee {
            background-color: #e2e3e5 !important;
            color: #383d41 !important;
            border-left: 4px solid #6c757d !important;
        }

        /* Styles pour les dates de réception */
        .date-reception-demain {
            background-color: #fff3cd !important;
            color: #856404 !important;
        }
        
        .date-reception-aujourdhui {
            color: #dc3545 !important;
            font-weight: bold !important;
        }
        
        .date-reception-depassee {
            background-color: #f8d7da !important;
            color: #721c24 !important;
            font-weight: bold !important;
            position: relative;
        }
        
        /* Styles pour les badges de date de réception */
        .badge.bg-warning {
            background-color: #dc3545 !important; /* Rouge pour URGENT */
            color: #fff !important;
            font-size: 0.75em;
            font-weight: bold;
        }
        
        .badge.bg-danger {
            background-color: #8b0000 !important; /* Rouge foncé pour DÉLAI DÉPASSÉ */
            color: #fff !important;
            font-size: 0.75em;
            font-weight: bold;
        }
        
        .badge.bg-info {
            background-color: #17a2b8 !important; /* Bleu pour PROCHE */
            color: #fff !important;
            font-size: 0.75em;
            font-weight: bold;
        }
        
        .date-reception-depassee::after {
            content: "⚠️ URGENT";
            position: absolute;
            top: -5px;
            right: -5px;
            background-color: #dc3545;
            color: white;
            font-size: 10px;
            padding: 2px 5px;
            border-radius: 3px;
            font-weight: bold;
        }

        /* Badges de statut */
        .badge-statut {
            font-size: 0.75em;
            padding: 0.25em 0.5em;
        }
        
        .badge-ouvert {
            background-color: #28a745;
            color: white;
        }
        
        .badge-convertie {
            background-color: #6c757d;
            color: white;
        }
        
        .badge-annulee {
            background-color: #dc3545;
            color: white;
        }
        
        .badge-archivee {
            background-color: #6c757d;
            color: white;
        }

        
        .vente-precommande:hover {
            background-color: #bbdefb !important;
        }
        
        .performance-slider-track {
            height: 6px;
            background: #e9ecef;
            border-radius: 3px;
            position: relative;
        }
        
        .performance-slider-fill {
            position: absolute;
            height: 100%;
            background: #007bff;
            border-radius: 3px 0 0 3px;
        }
        
        .performance-threshold-label {
            font-size: 14px;
            margin-bottom: 5px;
            display: block;
        }
        
        input[type=range].performance-slider {
            -webkit-appearance: none;
            width: 100%;
            background: transparent;
            position: absolute;
            top: 23px;
            left: 0;
            margin: 0;
            z-index: 5;
        }
        
        input[type=range].performance-slider:focus {
            outline: none;
        }
        
        input[type=range].performance-slider::-webkit-slider-thumb {
            -webkit-appearance: none;
            height: 20px;
            width: 20px;
            border-radius: 50%;
            background: #007bff;
            cursor: pointer;
            margin-top: -7px;
            border: 2px solid white;
            box-shadow: 0 0 5px rgba(0,0,0,0.3);
        }
        
        input[type=range].performance-slider::-moz-range-thumb {
            height: 20px;
            width: 20px;
            border-radius: 50%;
            background: #007bff;
            cursor: pointer;
            border: 2px solid white;
            box-shadow: 0 0 5px rgba(0,0,0,0.3);
        }
        
        .threshold-value-display {
            background: #f8f9fa;
            border: 1px solid #dee2e6;
            border-radius: 4px;
            padding: 4px 8px;
            min-width: 45px;
            text-align: center;
            font-weight: bold;
        }
    </style>
</head>
<body>
    <div class="container-fluid navbar-container">
        <nav class="navbar navbar-expand-lg navbar-dark bg-primary">
            <div class="container-fluid">
                <a class="navbar-brand" href="#">
                    <img src="image/LogoMatixVect.png" alt="Matix Logo" height="90" class="d-inline-block align-text-top me-2">
                </a>
                <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarNav">
                    <span class="navbar-toggler-icon"></span>
                </button>
                <div class="collapse navbar-collapse" id="navbarNav">
                    <ul class="navbar-nav me-auto">
                        <li class="nav-item">
                            <a class="nav-link active" href="#" id="saisie-tab">Saisie</a>
                        </li>
                        <li class="nav-item">
                            <a class="nav-link" href="#" id="visualisation-tab">Visualisation</a>
                        </li>
                        <!--<li class="nav-item" id="import-tab-container">
                            <a class="nav-link" href="#" id="import-tab">Import</a>
                        </li>-->
                        <li class="nav-item" id="stock-inventaire-item" style="display: none;">
                            <a class="nav-link" href="#" id="stock-inventaire-tab">Stock inventaire</a>
                        </li>
                        <li class="nav-item" id="copier-stock-item">
                            <a class="nav-link" href="#" id="copier-stock-tab">Copier Stock</a>
                        </li>
                      
                        <li class="nav-item" id="reconciliation-item">
                            <a class="nav-link" href="#" id="reconciliation-tab">Réconciliation</a>
                        </li>
                        <li class="nav-item" id="reconciliation-mois-item">
                            <a class="nav-link" href="#" id="reconciliation-mois-tab">Réconciliation du mois</a>
                        </li>
                        <li class="nav-item" id="stock-alerte-item">
                            <a class="nav-link" href="#" id="stock-alerte-tab">Accumulation de stock alerte</a>
                        </li>
                        <li class="nav-item" id="cash-payment-item">
                            <a class="nav-link" href="#" id="cash-payment-tab">Cash Paiement</a>
                        </li>
                        <li class="nav-item" id="suivi-achat-boeuf-item">
                            <a class="nav-link" href="#" id="suivi-achat-boeuf-tab">Suivi achat boeuf</a>
                        </li>
                        <li class="nav-item" id="estimation-item">
                            <a class="nav-link" href="#" id="estimation-tab">
                                <i class="bi bi-graph-up"></i> Estimation
                            </a>
                        </li>
                        <li class="nav-item" id="precommande-item">
                            <a class="nav-link" href="#" id="precommande-tab">
                                <i class="bi bi-cart-plus"></i> Pré-commande clients
                            </a>
                        </li>
                    </ul>
                    <div class="navbar-nav">
                        <span class="nav-item nav-link" id="user-info"></span>
                        <a class="nav-link" href="#" id="logout-btn">Déconnexion</a>
                    </div>
                </div>
            </div>
        </nav>
    </div>

    <div class="container-fluid main-content">
        <div class="content mt-4">
            <!-- Formulaire de saisie -->
            <div id="saisie-section">
                <div class="card">
                    <div class="card-header">
                        <h5 class="card-title mb-0">Saisie des ventes</h5>
                    </div>
                    <div class="card-body">
                        <form id="vente-form">
                            <div class="row mb-3">
                                <div class="col-md-4">
                                    <label for="date" class="form-label">Date *</label>
                                    <input type="text" class="form-control" id="date" required>
                                </div>
                                <div class="col-md-4">
                                    <label for="point-vente" class="form-label">Point de Vente *</label>
                                    <select class="form-select" id="point-vente" required>
                                        <option value="">Sélectionner un point de vente</option>
                                    </select>
                                </div>
                            </div>
                            
                            <!-- Informations Client -->
                            <div class="row mb-3">
                                <div class="col-12 mb-2">
                                    <small class="text-muted">
                                        <i class="bi bi-info-circle"></i> 
                                        Les informations client sont optionnelles. Si renseignées, elles seront appliquées à tous les produits de cette commande.
                                    </small>
                                </div>
                                <div class="col-md-3">
                                    <label for="client-nom" class="form-label">Nom Client</label>
                                    <input type="text" class="form-control" id="client-nom" placeholder="Nom du client">
                                </div>
                                <div class="col-md-3">
                                    <label for="client-numero" class="form-label">Numéro Client</label>
                                    <input type="text" class="form-control" id="client-numero" placeholder="Ex: 773900000">
                                </div>
                                <div class="col-md-3">
                                    <label for="client-adresse" class="form-label">Adresse Client</label>
                                    <input type="text" class="form-control" id="client-adresse" placeholder="Adresse du client">
                                </div>
                                <div class="col-md-3">
                                    <label for="client-creance" class="form-label">Créance</label>
                                    <select class="form-select" id="client-creance">
                                        <option value="false">Non</option>
                                        <option value="true">Oui</option>
                                    </select>
                                </div>
                            </div>

                            <div id="produits-container">
                                <div class="produit-entry mb-3">
                                    <div class="row">
                                        <div class="col-md-3">
                                            <label class="form-label">Catégorie *</label>
                                            <select class="form-select categorie-select" required>
                                                <option value="">Sélectionner une catégorie</option>
                                            </select>
                                        </div>
                                        <div class="col-md-3">
                                            <label class="form-label">Produit *</label>
                                            <select class="form-select produit-select" required>
                                                <option value="">Sélectionner un produit</option>
                                            </select>
                                        </div>
                                        <div class="col-md-2">
                                            <label class="form-label">Prix Unit. *</label>
                                            <input type="number" class="form-control prix-unit" required>
                                        </div>
                                        <div class="col-md-2">
                                            <label class="form-label">Quantité *</label>
                                            <input type="number" class="form-control quantite" step="0.001" required>
                                        </div>
                                        <div class="col-md-2">
                                            <label class="form-label">Total</label>
                                            <input type="number" class="form-control total" readonly>
                                        </div>
                                    </div>

                                </div>
                            </div>

                            <button type="button" class="btn btn-secondary mb-3" id="ajouter-produit">
                                Ajouter un produit
                            </button>

                            <div class="small text-muted mb-3">
                                * Champs obligatoires
                            </div>

                            <div class="row">
                                <div class="col-md-6">
                                    <div class="card">
                                        <div class="card-body">
                                            <h6>Total Général</h6>
                                            <h3 id="total-general">0 FCFA</h3>
                                        </div>
                                    </div>
                                </div>
                                <div class="col-md-6">
                                    <button type="submit" class="btn btn-primary w-100">Enregistrer</button>
                                </div>
                            </div>
                        </form>

                        <!-- Tableau des dernières ventes -->
                        <div class="mt-4">
                            <div class="d-flex justify-content-between align-items-center mb-3">
                                <h5>Dernières ventes enregistrées</h5>
                                <div class="text-muted">
                                    <span id="total-ventes"></span>
                                    <span id="derniere-mise-a-jour" class="ms-3"></span>
                                </div>
                            </div>
                            <div class="table-responsive">
                                <table id="dernieres-ventes" class="table table-striped">
                                    <thead>
                                        <tr>
                                            <th>Mois</th>
                                            <th>Date</th>
                                            <th>Semaine</th>
                                            <th>Point de Vente</th>
                                            <th>Préparation</th>
                                            <th>Catégorie</th>
                                            <th>Produit</th>
                                            <th>Prix Unitaire</th>
                                            <th>Nombre</th>
                                            <th>Montant</th>
                                            <th>Nom Client</th>
                                            <th>Numéro Client</th>
                                            <th>Adresse Client</th>
                                            <th>Créance</th>
                                            <th>Actions</th>
                                        </tr>
                                    </thead>
                                    <tbody></tbody>
                                </table>
                            </div>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Section de pré-commandes -->
            <div id="precommande-section" class="content-section" style="display: none;">
                <div class="card">
                    <div class="card-header">
                        <h5 class="card-title mb-0">Saisie des pré-commandes clients</h5>
                    </div>
                    <div class="card-body">
                        <form id="precommande-form">
                            <div class="row mb-3">
                                <div class="col-md-3">
                                    <label for="precommande-date-enregistrement" class="form-label">Date d'enregistrement *</label>
                                    <input type="text" class="form-control" id="precommande-date-enregistrement" required>
                                </div>
                                <div class="col-md-3">
                                    <label for="precommande-date-reception" class="form-label">Date de réception *</label>
                                    <input type="text" class="form-control" id="precommande-date-reception" required>
                                </div>
                                <div class="col-md-3">
                                    <label for="precommande-point-vente" class="form-label">Point de Vente *</label>
                                    <select class="form-select" id="precommande-point-vente" required>
                                        <option value="">Sélectionner un point de vente</option>
                                    </select>
                                </div>
                                                        <div class="col-md-3">
                            <label for="precommande-label" class="form-label">Label/Tag</label>
                            <input type="text" class="form-control" id="precommande-label" placeholder="Entrez un label (optionnel)">
                        </div>
                            </div>
                            
                            <!-- Informations Client -->
                            <div class="row mb-3">
                                <div class="col-12 mb-2">
                                    <small class="text-muted">
                                        <i class="bi bi-info-circle"></i> 
                                        Les informations client sont optionnelles. Si renseignées, elles seront appliquées à tous les produits de cette pré-commande.
                                    </small>
                                </div>
                                <div class="col-md-3">
                                    <label for="precommande-client-nom" class="form-label">Nom Client</label>
                                    <input type="text" class="form-control" id="precommande-client-nom" placeholder="Nom du client">
                                </div>
                                <div class="col-md-3">
                                    <label for="precommande-client-numero" class="form-label">Numéro Client</label>
                                    <input type="text" class="form-control" id="precommande-client-numero" placeholder="Ex: 773900000">
                                </div>
                                <div class="col-md-3">
                                    <label for="precommande-client-adresse" class="form-label">Adresse Client</label>
                                    <input type="text" class="form-control" id="precommande-client-adresse" placeholder="Adresse du client">
                                </div>
                                <div class="col-md-3">
                                    <label for="precommande-commentaire" class="form-label">Commentaire</label>
                                    <input type="text" class="form-control" id="precommande-commentaire" placeholder="Notes supplémentaires...">
                                </div>
                            </div>

                            <div id="precommande-produits-container">
                                <div class="precommande-produit-entry mb-3">
                                    <div class="row">
                                        <div class="col-md-3">
                                            <label class="form-label">Catégorie *</label>
                                            <select class="form-select precommande-categorie-select" required>
                                                <option value="">Sélectionner une catégorie</option>
                                            </select>
                                        </div>
                                        <div class="col-md-3">
                                            <label class="form-label">Produit *</label>
                                            <select class="form-select precommande-produit-select" required>
                                                <option value="">Sélectionner un produit</option>
                                            </select>
                                        </div>
                                        <div class="col-md-2">
                                            <label class="form-label">Prix Unit. *</label>
                                            <input type="number" class="form-control precommande-prix-unit" required>
                                        </div>
                                        <div class="col-md-2">
                                            <label class="form-label">Quantité *</label>
                                            <input type="number" class="form-control precommande-quantite" step="0.001" required>
                                        </div>
                                        <div class="col-md-2">
                                            <label class="form-label">Total</label>
                                            <input type="number" class="form-control precommande-total" readonly>
                                        </div>
                                    </div>
                                </div>
                            </div>

                            <button type="button" class="btn btn-secondary mb-3" id="ajouter-produit-precommande">
                                Ajouter un produit
                            </button>

                            <div class="small text-muted mb-3">
                                * Champs obligatoires
                            </div>

                            <div class="row">
                                <div class="col-md-6">
                                    <div class="card">
                                        <div class="card-body">
                                            <h6>Total Général</h6>
                                            <h3 id="precommande-total-general">0 FCFA</h3>
                                        </div>
                                    </div>
                                </div>
                                <div class="col-md-6">
                                    <button type="submit" class="btn btn-primary w-100">Enregistrer Pré-commande</button>
                                </div>
                            </div>
                        </form>

                        <!-- Filtres et contrôles -->
                        <div class="mt-4">
                            <div class="row mb-3">
                                <div class="col-md-3">
                                    <label for="filter-precommande-date-debut" class="form-label">Date début</label>
                                    <input type="date" class="form-control" id="filter-precommande-date-debut">
                                </div>
                                <div class="col-md-3">
                                    <label for="filter-precommande-date-fin" class="form-label">Date fin</label>
                                    <input type="date" class="form-control" id="filter-precommande-date-fin">
                                </div>
                                <div class="col-md-3">
                                    <label for="filter-precommande-point-vente" class="form-label">Point de vente</label>
                                    <select class="form-select" id="filter-precommande-point-vente">
                                        <option value="tous">Tous les points de vente</option>
                                    </select>
                                </div>
                                <div class="col-md-3">
                                    <label for="filter-precommande-label" class="form-label">Label/Tag</label>
                                    <select class="form-select" id="filter-precommande-label">
                                        <option value="">Tous les labels</option>
                                    </select>
                                </div>
                                <div class="col-md-3">
                                    <div class="statut-filter-container">
                                        <button type="button" class="btn btn-outline-secondary w-100 d-flex justify-content-between align-items-center" id="statut-filter-toggle">
                                            <span id="statut-filter-label">Statut (1 sélectionné)</span>
                                            <i class="bi bi-chevron-down" id="statut-filter-icon"></i>
                                        </button>
                                        <div class="statut-checkboxes" id="statut-checkboxes" style="display: none;">
                                            <div class="form-check">
                                                <input class="form-check-input" type="checkbox" value="ouvert" id="statut-ouvert" checked>
                                                <label class="form-check-label" for="statut-ouvert">Ouvert</label>
                                            </div>
                                            <div class="form-check">
                                                <input class="form-check-input" type="checkbox" value="convertie" id="statut-convertie">
                                                <label class="form-check-label" for="statut-convertie">Convertie</label>
                                            </div>
                                            <div class="form-check">
                                                <input class="form-check-input" type="checkbox" value="annulee" id="statut-annulee">
                                                <label class="form-check-label" for="statut-annulee">Annulée</label>
                                            </div>
                                            <div class="form-check">
                                                <input class="form-check-input" type="checkbox" value="archivee" id="statut-archivee">
                                                <label class="form-check-label" for="statut-archivee">Archivée</label>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                            </div>
                            <div class="row mb-3">
                                <div class="col-md-12">
                                    <button type="button" class="btn btn-outline-primary" id="filtrer-precommandes">
                                        <i class="bi bi-funnel"></i> Filtrer
                                    </button>
                                    <button type="button" class="btn btn-outline-secondary" id="reset-filtres-precommandes">
                                        <i class="bi bi-arrow-clockwise"></i> Réinitialiser
                                    </button>
                                </div>
                            </div>
                        </div>

                        <!-- Tableau des pré-commandes -->
                        <div class="mt-4">
                            <div class="d-flex justify-content-between align-items-center mb-3">
                                <h5>Pré-commandes enregistrées</h5>
                                <div class="text-muted">
                                    <span id="total-precommandes"></span>
                                    <span id="derniere-mise-a-jour-precommandes" class="ms-3"></span>
                                </div>
                            </div>
                            <div class="table-responsive">
                                <table id="precommandes-table" class="table table-striped">
                                    <thead>
                                        <tr>
                                            <th>Mois</th>
                                            <th>Date Enregistrement</th>
                                            <th>Date Réception</th>
                                            <th>Semaine</th>
                                            <th>Point de Vente</th>
                                            <th>Préparation</th>
                                            <th>Catégorie</th>
                                            <th>Produit</th>
                                            <th>Prix Unitaire</th>
                                            <th>Nombre</th>
                                            <th>Montant</th>
                                            <th>Nom Client</th>
                                            <th>Numéro Client</th>
                                            <th>Adresse Client</th>
                                            <th>Commentaire</th>
                                            <th>Label</th>
                                            <th>Statut</th>
                                            <th>Actions</th>
                                        </tr>
                                    </thead>
                                    <tbody></tbody>
                                </table>
                            </div>
                            
                            <!-- Pagination des pré-commandes -->
                            <div id="precommandes-pagination" class="mt-3"></div>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Section de visualisation -->
            <div id="visualisation-section" class="content-section" style="display: none;">
                <div class="row mb-4">
                    <div class="col-12">
                        <div class="card">
                            <div class="card-body">
                                <div class="row">
                                    <div class="col-md-3">
                                        <label for="periode-select" class="form-label">Période</label>
                                        <select class="form-select" id="periode-select">
                                            <option value="jour">Aujourd'hui</option>
                                            <option value="semaine">Cette semaine</option>
                                            <option value="mois">Ce mois</option>
                                            <option value="personnalise">Personnalisé</option>
                                        </select>
                                    </div>
                                    <div class="col-md-3">
                                        <label for="date-debut" class="form-label">Date de début</label>
                                        <input type="text" class="form-control" id="date-debut">
                                    </div>
                                    <div class="col-md-3">
                                        <label for="date-fin" class="form-label">Date de fin</label>
                                        <input type="text" class="form-control" id="date-fin">
                                    </div>
                                    <div class="col-md-3">
                                        <label for="point-vente-select" class="form-label">Point de vente</label>
                                        <select class="form-select" id="point-vente-select" required>
                                            <option value="">Sélectionner un point de vente</option>
                                        </select>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
                <div class="row mb-4">
                    <div class="col-12">
                        <div class="card">
                            <div class="card-body">
                                <h5 class="card-title">Montant Total des Ventes</h5>
                                <h2 class="text-primary" id="montant-total">0 FCFA</h2>
                            </div>
                        </div>
                    </div>
                </div>
                <div class="row mb-4 visualisation-charts">
                    <div class="col-md-6">
                        <div class="card">
                            <div class="card-body">
                                <h5 class="card-title">Ventes par Jour</h5>
                                <div style="height: 400px;">
                                    <canvas id="ventesParMoisChart"></canvas>
                                </div>
                            </div>
                        </div>
                    </div>
                    <div class="col-md-6">
                        <div class="card">
                            <div class="card-body">
                                <h5 class="card-title">Ventes par Produit</h5>
                                <div style="height: 400px;">
                                    <canvas id="ventesParProduitChart"></canvas>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
                <div class="row mb-4 visualisation-charts">
                    <div class="col-12">
                        <div class="card">
                            <div class="card-body">
                                <div class="d-flex justify-content-between align-items-center mb-3">
                                    <h5 class="card-title mb-0">Ventes par Point de Vente</h5>
                                    <div class="d-flex align-items-center gap-3">
                                        <div class="d-flex align-items-center">
                                            <label for="moisFilterPointVente" class="form-label me-2 mb-0">Mois :</label>
                                            <input type="month" class="form-control form-control-sm" id="moisFilterPointVente" style="width: 150px;">
                                        </div>
                                        <div class="btn-group" role="group" aria-label="Actions tableau">
                                            <button type="button" class="btn btn-outline-success btn-sm" id="exportExcelPointVente" title="Exporter en Excel">
                                                <i class="fas fa-file-excel"></i> Excel
                                            </button>
                                            <button type="button" class="btn btn-outline-primary btn-sm" id="copyTablePointVente" title="Copier le tableau">
                                                <i class="fas fa-copy"></i> Copier
                                            </button>
                                        </div>
                                    </div>
                                </div>
                                <div class="table-responsive">
                                    <table class="table table-striped table-hover" id="ventesParPointVenteTable">
                                        <thead class="table-dark">
                                            <tr>
                                                <th>Point de Vente</th>
                                                <th class="text-end">Montant Total (FCFA)</th>
                                                <th class="text-end">Pourcentage</th>
                                                <th class="text-end">Nombre de Ventes</th>
                                            </tr>
                                        </thead>
                                        <tbody id="ventesParPointVenteBody">
                                            <!-- Données à charger dynamiquement -->
                                        </tbody>
                                    </table>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
                <div class="row mb-4 visualisation-charts">
                    <div class="col-12">
                        <div class="card">
                            <div class="card-body">
                                <h5 class="card-title">Ventes par Catégorie</h5>
                                <div style="height: 400px;">
                                    <canvas id="ventesParCategorieChart"></canvas>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
                <!-- Section Analytics -->
                <div class="row mb-4 visualisation-charts">
                    <div class="col-12">
                        <div class="card">
                            <div class="card-body">
                                <h5 class="card-title">Analytics des Ventes</h5>
                                <div class="row" id="analytics-container">
                                    <!-- Les données analytics seront chargées dynamiquement ici -->
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
                <div class="row visualisation-data">
                    <div class="col-12">
                        <div class="card">
                            <div class="card-body">
                                <div class="d-flex justify-content-between align-items-center mb-3">
                                    <h5 class="card-title mb-0">Tableau des Ventes</h5>
                                    <div>
                                        <button class="btn btn-success me-2" id="export-visualisation-excel">
                                            <i class="bi bi-file-earmark-excel"></i> Export Excel
                                        </button>
                                        <span id="pagination-info" class="me-2"></span>
                                        <div id="pagination-buttons" class="btn-group"></div>
                                    </div>
                                </div>
                                <div class="table-responsive">
                                    <table id="tableau-ventes" class="table table-striped">
                                        <thead>
                                            <tr>
                                                <th>Mois</th>
                                                <th>Date</th>
                                                <th>Semaine</th>
                                                <th>Point de Vente</th>
                                                <th>Préparation</th>
                                                <th>Catégorie</th>
                                                <th>Produit</th>
                                                <th>Prix Unitaire</th>
                                                <th>Quantité</th>
                                                <th>Montant</th>
                                                <th>Nom Client</th>
                                                <th>Numéro Client</th>
                                                <th>Adresse Client</th>
                                                <th>Créance</th>
                                            </tr>
                                        </thead>
                                        <tbody></tbody>
                                    </table>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Section d'importation -->
            <div id="import-section" class="content-section" style="display: none;">
                <div class="card">
                    <div class="card-header">
                        <h5 class="card-title mb-0">Importation de données</h5>
                    </div>
                    <div class="card-body">
                        <form id="import-form">
                            <div class="mb-3">
                                <label for="file-import" class="form-label">Fichier Excel ou CSV</label>
                                <input type="file" class="form-control" id="file-import" accept=".xlsx,.csv" required>
                                <div class="form-text">
                                    Format accepté : fichier Excel (.xlsx) ou CSV avec les colonnes suivantes :<br>
                                    Mois, Date, Semaine, Point de Vente, Preparation, Catégorie, Produit, PU, Nombre, Montant<br>
                                    Les points de vente seront automatiquement importés selon les données du fichier.
                                </div>
                            </div>
                            <div class="d-flex gap-2 mb-3">
                                <button type="submit" class="btn btn-primary">Aperçu</button>
                                <button type="button" id="save-import" class="btn btn-success" disabled>Sauvegarder</button>
                            </div>
                        </form>

                        <div class="mt-4">
                            <h5>Aperçu des données</h5>
                            <div class="table-responsive">
                                <table class="table table-striped" id="preview-table">
                                    <thead>
                                        <tr>
                                            <th>Mois</th>
                                            <th>Date</th>
                                            <th style="width: 80px;">Sem.</th>
                                            <th>Point de Vente</th>
                                            <th>Preparation</th>
                                            <th>Catégorie</th>
                                            <th>Produit</th>
                                            <th>PU</th>
                                            <th>Nombre</th>
                                            <th>Montant</th>
                                            <th style="width: 50px;">Action</th>
                                        </tr>
                                    </thead>
                                    <tbody></tbody>
                                </table>
                            </div>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Section Stock inventaire -->
            <div id="stock-inventaire-section" class="container-fluid mt-4" style="display: none;">
                <div class="row">
                    <div class="col-md-3">
                        <div class="form-group mb-3">
                            <label for="type-stock" class="form-label">Type de stock</label>
                            <select id="type-stock" class="form-select">
                                <option value="matin">Stock Matin</option>
                                <option value="soir">Stock Soir</option>
                            </select>
                        </div>
                    </div>
                    <div class="col-md-3">
                        <div class="form-group mb-3">
                            <label for="date-inventaire" class="form-label">Date</label>
                            <input type="text" id="date-inventaire" class="form-control" required>
                        </div>
                    </div>
                    <div class="col-md-6">
                        <div class="form-group mb-3">
                            <label class="form-label">&nbsp;</label>
                            <div>
                                <div class="mb-3">
                                    <button type="button" class="btn btn-primary" id="import-csv" style="display: none;">
                                        <i class="fas fa-file-import"></i> Importer CSV
                                    </button>
                                    <input type="file" id="csv-file" accept=".csv" style="display: none;">
                                </div>

                                <!-- Section d'aperçu pour l'import CSV -->
                                <div id="previewSection" style="display: none;" class="card mb-3">
                                    <div class="card-header">
                                        <h5 class="card-title mb-0">Aperçu des données à importer</h5>
                                    </div>
                                    <div class="card-body">
                                        <div class="table-responsive">
                                            <table class="table table-bordered table-hover" id="previewTable">
                                                <thead>
                                                    <tr>
                                                        <th>Point de Vente</th>
                                                        <th>Date</th>
                                                        <th>Produit</th>
                                                        <th>Stock Matin</th>
                                                        <th>Stock Soir</th>
                                                        <th>Transfert</th>
                                                        <th>Actions</th>
                                                    </tr>
                                                </thead>
                                                <tbody>
                                                </tbody>
                                            </table>
                                        </div>
                                        <div class="mt-3">
                                            <button type="button" class="btn btn-success" id="confirmImport">
                                                <i class="fas fa-check"></i> Confirmer l'import
                                            </button>
                                            <button type="button" class="btn btn-danger" id="cancelImport">
                                                <i class="fas fa-times"></i> Annuler
                                            </button>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- Filtres pour le stock -->
                <div class="row mb-3">
                    <div class="col-md-6">
                        <div class="form-group">
                            <label for="filtre-point-vente" class="form-label">Filtrer par Point de Vente</label>
                            <!-- refacto to read points-vente.js -->
                            <select id="filtre-point-vente" class="form-select">
                                <option value="">Sélectionner un point de vente</option>
                            </select>
                        </div>
                    </div>
                    <div class="col-md-6">
                        <div class="form-group">
                            <label for="filtre-produit" class="form-label">Filtrer par Produit</label>
                            <select id="filtre-produit" class="form-select">
                                <!-- Options peuplées dynamiquement depuis produitsInventaire.js -->
                                <option value="tous">Tous les produits</option>
                            </select>
                        </div>
                    </div>
                </div>
                
                <!-- Filtre pour masquer les quantités à zéro -->
                <div class="row mb-3">
                    <div class="col-md-6">
                        <div class="form-check">
                            <input class="form-check-input" type="checkbox" id="masquer-quantite-zero">
                            <label class="form-check-label" for="masquer-quantite-zero">
                                Masquer les produits avec quantité à zéro
                            </label>
                        </div>
                    </div>
                    <div class="col-md-6 text-end">
                        <button id="export-stock-excel" class="btn btn-success me-2">
                            <i class="bi bi-file-earmark-excel"></i> Export Excel
                        </button>
                        <button id="btn-aller-reconciliation" class="btn btn-primary">Aller à la rec.</button>
                    </div>
                </div>

                <!-- Tableau de stock -->
                <div class="card mb-4">
                    <div class="card-header">
                        <h5 class="card-title mb-0">Stock</h5>
                    </div>
                    <div class="card-body">
                        <div class="table-responsive">
                            <table id="stock-table" class="table table-bordered table-hover">
                                <thead>
                                    <tr>
                                        <th>Point de Vente</th>
                                        <th>Produit</th>
                                        <th>Quantité</th>
                                        <th>Prix Unitaire</th>
                                        <th>Total</th>
                                        <th>Commentaire</th>
                                        <th>Actions</th>
                                    </tr>
                                </thead>
                                <tbody></tbody>
                            </table>
                        </div>
                        <div class="mt-3">
                            <button id="add-stock-row" class="btn btn-primary">
                                <i class="fas fa-plus"></i> Ajouter une ligne
                            </button>
                            <button id="save-stock" class="btn btn-success ms-2">
                                <i class="fas fa-save"></i> Sauvegarder le stock
                            </button>
                        </div>
                    </div>
                </div>

                <!-- Tableau de transfert -->
                <div class="card mt-4">
                    <div class="card-header">
                        <h5>Transfert</h5>
                    </div>
                    <div class="card-body">
                        <!-- Filtres pour les transferts -->
                        <div class="row mb-3">
                            <div class="col-md-6">
                                <div class="form-group">
                                    <label for="filtre-point-vente-transfert" class="form-label">Filtrer par Point de Vente</label>
                                    <select id="filtre-point-vente-transfert" class="form-select">
                                        <option value="">Tous les points de vente</option>
                                    </select>
                                </div>
                            </div>
                            <div class="col-md-6">
                                <div class="form-group">
                                    <label for="filtre-produit-transfert" class="form-label">Filtrer par Produit</label>
                                    <select id="filtre-produit-transfert" class="form-select">
                                        <option value="">Tous les produits</option>
                                        <option value="Boeuf">Boeuf</option>
                                        <option value="Veau">Veau</option>
                                        <option value="Poulet">Poulet</option>
                                        <option value="Tete De Mouton">Tête de Mouton</option>
                                        <option value="Tablette">Tablette</option>
                                        <option value="Foie">Foie</option>
                                        <option value="Yell">Yell</option>
                                        <option value="Agneau">Agneau</option>
                                        <option value="Abats">Abats</option>
                                    </select>
                                </div>
                            </div>
                        </div>
                        <table class="table" id="transfertTable">
                            <thead>
                                <tr>
                                    <th>Point de Vente</th>
                                    <th>Produit</th>
                                    <th>Impact (+/-)</th>
                                    <th>Quantité</th>
                                    <th>Prix Unitaire</th>
                                    <th>Total</th>
                                    <th>Commentaire</th>
                                    <th>Actions</th>
                                </tr>
                            </thead>
                            <tbody>
                            </tbody>
                            <tfoot>
                                <!-- Le bouton d'ajout de ligne sera ajouté ici dynamiquement -->
                            </tfoot>
                        </table>
                        <div class="mt-3">
                            <button class="btn btn-primary" id="ajouterLigne">Ajouter une ligne</button>
                            <button class="btn btn-success" id="sauvegarderTransfert">Sauvegarder le transfert</button>
                        </div>
                    </div>
                </div>
            </div>
            
            <!-- Section Copier Stock -->
            <div id="copier-stock-section" class="container-fluid mt-4" style="display: none;">
                <div class="card">
                    <div class="card-header bg-info text-white">
                        <h5 class="card-title mb-0"><i class="fas fa-copy"></i> Copier le stock d'une date à une autre</h5>
                    </div>
                    <div class="card-body">
                        <div class="row">
                            <div class="col-md-6">
                                <div class="card mb-4">
                                    <div class="card-header bg-primary text-white">
                                        <h6 class="card-title mb-0">Source</h6>
                                    </div>
                                    <div class="card-body">
                                        <div class="form-group mb-3">
                                            <label for="source-type-stock" class="form-label">Type de stock</label>
                                            <select id="source-type-stock" class="form-select">
                                                <option value="matin">Stock Matin</option>
                                                <option value="soir">Stock Soir</option>
                                            </select>
                                        </div>
                                        <div class="form-group">
                                            <label for="source-date" class="form-label">Date</label>
                                            <input type="text" id="source-date" class="form-control">
                                        </div>
                                    </div>
                                </div>
                            </div>
                            <div class="col-md-6">
                                <div class="card mb-4">
                                    <div class="card-header bg-success text-white">
                                        <h6 class="card-title mb-0">Destination</h6>
                                    </div>
                                    <div class="card-body">
                                        <div class="form-group mb-3">
                                            <label for="destination-type-stock" class="form-label">Type de stock</label>
                                            <select id="destination-type-stock" class="form-select">
                                                <option value="matin">Stock Matin</option>
                                                <option value="soir">Stock Soir</option>
                                            </select>
                                        </div>
                                        <div class="form-group">
                                            <label for="destination-date" class="form-label">Date</label>
                                            <input type="text" id="destination-date" class="form-control">
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                        
                        <!-- Options de copie -->
                        <div class="row mt-3">
                            <div class="col-12">
                                <div class="card">
                                    <div class="card-header bg-light">
                                        <h6 class="card-title mb-0"><i class="fas fa-cog"></i> Options de copie</h6>
                                    </div>
                                    <div class="card-body">
                                        <div class="form-check">
                                            <input type="checkbox" class="form-check-input" id="copy-comments">
                                            <label class="form-check-label" for="copy-comments">
                                                <i class="fas fa-comment"></i> Copier également les commentaires
                                                <small class="text-muted d-block">Si décoché, les commentaires ne seront pas copiés avec les données de stock</small>
                                            </label>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                        
                        <div class="text-center mt-3">
                            <button type="button" class="btn btn-primary btn-lg" id="copy-stock">
                                <i class="fas fa-copy"></i> Copier le stock
                            </button>
                        </div>
                    </div>
                </div>
            </div>
            
            <!-- Section Réconciliation -->
            <div id="reconciliation-section" class="container-fluid mt-4 content-section" style="display: none;">
                <div class="row">
                    <div class="col-md-12">
                        <div class="card">
                            <div class="card-header d-flex justify-content-between align-items-center">
                                <h5 class="card-title mb-0">Réconciliation Stock / Ventes</h5>
                                <span class="small text-muted" id="sync-status-reconciliation"></span>
                            </div>
                            <div class="card-body">
                                <div class="row mb-3">
                                    <div class="col-md-3">
                                        <label for="date-reconciliation" class="form-label">Date</label>
                                        <input type="text" class="form-control" id="date-reconciliation" placeholder="Sélectionner une date">
                                        <div id="date-reconciliation-display" class="form-text" style="display: none;"></div>
                                    </div>
                                    <div class="col-md-3">
                                        <label for="point-vente-filtre" class="form-label">Point de Vente</label>
                                        <select class="form-select" id="point-vente-filtre">
                                            <option value="">Tous les points de vente</option>
                                            <!-- Options will be populated dynamically -->
                                        </select>
                                    </div>
                                    <div class="col-md-6 d-flex align-items-end">
                                        <button class="btn btn-primary me-2" id="calculer-reconciliation">Calculer</button>
                                        <button class="btn btn-success me-2" id="sauvegarder-reconciliation" disabled>Sauvegarder</button>
                                        <button class="btn btn-secondary" id="charger-commentaires" onclick="ReconciliationManager.chargerCommentaires(); return false;">Charger les commentaires</button>
                                    </div>
                                </div>
                                
                                <div id="loading-indicator-reconciliation" class="text-center" style="display: none;">
                                    <div class="spinner-border text-primary" role="status">
                                        <span class="visually-hidden">Chargement...</span>
                                    </div>
                                    <p>Calcul en cours, veuillez patienter...</p>
                                </div>
                                
                                <!-- Information sur la pération pour abattage -->
                                <div class="alert alert-info mb-3" id="peration-info" style="display: none;">
                                    <h6 class="alert-heading">
                                        <i class="bi bi-info-circle"></i> 
                                        Information sur la "Pération" (Point de vente Abattage)
                                    </h6>
                                    <p class="mb-1">
                                        <strong>Pération :</strong> Perte de volume entre l'abattoir et le point de vente.
                                    </p>
                                    <p class="mb-0">
                                        <strong>Calcul :</strong> (Ventes Théoriques / Stock Matin) × 100
                                    </p>
                                    <small class="text-muted">
                                        Plus le pourcentage est élevé, plus l'efficacité de vente est bonne.
                                    </small>
                                </div>
                                
                                <div class="table-responsive">
                                    <table id="reconciliation-table" class="table table-striped table-bordered">
                                        <thead>
                                            <tr>
                                                <th>Date</th>
                                                <th>Point de Vente</th>
                                                <th class="text-end">Stock Matin</th>
                                                <th class="text-end">Stock Soir</th>
                                                <th class="text-end">Transferts</th>
                                                <th class="text-end">Ventes Théoriques</th>
                                                <th class="text-end">Ventes Saisies</th>
                                                <th class="text-end">Écart</th>
                                                <th class="text-end">Montant Total Cash</th>
                                                <th class="text-end">Écart %</th>
                                                <th class="text-end">Ecart Cash</th>
                                                <th>Commentaire</th>
                                            </tr>
                                        </thead>
                                        <tbody>
                                            <!-- Données de réconciliation générées dynamiquement -->
                                        </tbody>
                                    </table>
                                </div>
                                
                                <!-- Conteneur pour les détails -->
                                <div id="debug-container" class="mt-4" style="display: none;">
                                    <h5>Détails de la réconciliation</h5>
                                    <div class="card">
                                        <div class="card-body">
                                            <div id="debug-title" class="mb-3"></div>
                                            <div id="debug-formule" class="mb-3"></div>
                                            <div id="debug-ecart" class="mb-3"></div>
                                            <h6 class="mt-4">Détails des composantes</h6>
                                            <div id="debug-stock-section" class="mt-3"></div>
                                            <div id="debug-ventes-section" class="mt-3"></div>
                                        </div>
                                    </div>
                                </div>
                                
                                <!-- Section pour l'analyse LLM -->
                                <div id="llm-analyse-container" class="mt-4" style="display: none;">
                                    <div class="d-flex justify-content-between align-items-center mb-2">
                                        <h5>Analyse des résultats</h5>
                                        <div>
                                            <span id="llm-status" class="badge bg-info me-2">En attente</span>
                                            <button id="demander-analyse-llm" class="btn btn-outline-primary btn-sm">
                                                <i class="bi bi-robot"></i> Analyser les résultats
                                            </button>
                                        </div>
                                    </div>
                                    <div class="card">
                                        <div class="card-body">
                                            <div id="llm-loading" class="text-center d-none">
                                                <div class="spinner-border text-primary" role="status">
                                                    <span class="visually-hidden">Chargement...</span>
                                                </div>
                                                <p>Analyse en cours, veuillez patienter...</p>
                                            </div>
                                            <div id="llm-result"></div>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Section Alertes de stock -->
            <div class="card mb-4" id="stock-alerte-section" style="display: none;">
                <div class="card-header">
                    <h2>Alertes d'accumulation de stock</h2>
                </div>
                <div class="card-body">
                    <div class="row">
                        <div class="col-md-4 mb-3">
                            <label for="date-debut-alerte" class="form-label">Date de début</label>
                            <input type="date" class="form-control" id="date-debut-alerte">
                        </div>
                        <div class="col-md-4 mb-3">
                            <label for="date-fin-alerte" class="form-label">Date de fin</label>
                            <input type="date" class="form-control" id="date-fin-alerte">
                        </div>
                        <div class="col-md-2 mb-3">
                            <label for="pourcentage-alerte" class="form-label">Pourcentage de seuil (%)</label>
                            <input type="number" class="form-control" id="pourcentage-alerte" value="10">
                        </div>
                        <div class="col-md-2 mb-3 d-flex align-items-end">
                            <button class="btn btn-primary w-100" id="btn-rechercher-alertes">Rechercher les alertes</button>
                        </div>
                    </div>
                    
                    <div class="alert alert-info">
                        <p>Cet outil recherche:</p>
                        <ul>
                            <li><strong>Accumulation</strong>: produits dont le stock soir dépasse 90% du (stock matin + transferts) <strong>et</strong> dont la différence est positive.</li>
                            <li><strong>Apparition</strong>: produits présents en stock soir mais absents du stock matin.</li>
                        </ul>
                        <p>Exemple avec seuil à 10%: accumulation si stock soir > 90% (stock matin + transferts) <strong>et</strong> différence > 0.</p>
                    </div>
                    
                    <div class="text-center my-3" id="loading-indicator-alertes" style="display: none;">
                        <div class="spinner-border text-primary" role="status">
                            <span class="visually-hidden">Chargement...</span>
                        </div>
                        <p>Recherche des alertes en cours...</p>
                    </div>
                    
                    <div class="alert alert-success" id="no-alertes-message" style="display: none;">
                        Aucune accumulation de stock significative détectée pour la période sélectionnée.
                    </div>
                    
                    <div class="table-responsive">
                        <table class="table table-hover table-striped" id="alertes-table">
                            <thead>
                                <tr>
                                    <th>Point de Vente</th>
                                    <th>Produit</th>
                                    <th>Date</th>
                                    <th class="text-end">Stock Matin</th>
                                    <th class="text-end">Stock Soir</th>
                                    <th class="text-end">Transferts</th>
                                    <th class="text-end">Différence</th>
                                    <th class="text-end">Accumulation (%)</th>
                                </tr>
                            </thead>
                            <tbody>
                                <!-- Les alertes seront ajoutées ici dynamiquement -->
                            </tbody>
                        </table>
                    </div>
                </div>
            </div>

            <!-- Section Cash Paiement -->
            <div id="cash-payment-section" class="container-fluid mt-4" style="display: none;">
                <div class="row">
                    <div class="col-md-12">
                        <div class="card">
                            <div class="card-header d-flex justify-content-between align-items-center" id="cash-payment-header">
                                <h5 class="card-title mb-0" id="cash-payment-title">Importation et Analyse des Paiements en Espèces</h5>
                                <span class="small text-muted" id="sync-status-cash-payment"></span>
                            </div>
                            <div class="card-body">
                                <!-- Section d'importation cachée -->
                                <div class="row mb-4" id="cash-payment-import-section" style="display: none;">
                                    <div class="col-md-12">
                                        <div class="card bg-light">
                                            <div class="card-body">
                                                <h6 class="card-title">Importer des Données de Paiement</h6>
                                                <p class="small text-muted mb-3">
                                                    Importez un fichier CSV avec les en-têtes suivants: name, created_at, amount, merchant_fee, customer_fee, customer_name, customer_phone, Entete_Trans_Type, psp_name, payment_category, payment_means, payment_reference, merchant_reference, trn-status, tr_id, cust_country, AggregationMT, Total_Nom_Marchand, Total_Marchand, merchant_id, NameFirst
                                                </p>
                                                <div class="row">
                                                    <div class="col-md-9">
                                                        <input type="file" class="form-control" id="cash-payment-file" accept=".csv">
                                                    </div>
                                                    <div class="col-md-3 d-flex gap-2">
                                                        <button class="btn btn-primary flex-grow-1" id="import-cash-payment">Importer</button>
                                                        <button class="btn btn-success flex-grow-1" id="save-cash-payment">Sauvegarder</button>
                                                    </div>
                                                </div>
                                                <div class="mt-3">
                                                    <div class="alert alert-info">
                                                        <p class="mb-1"><strong>Mapping des références de paiement:</strong></p>
                                                        <div class="row small">
                                                            <div class="col-md-3">V_TB = Touba</div>
                                                            <div class="col-md-3">V_DHR = Dahra</div>
                                                            <div class="col-md-3">V_ALS = Aliou Sow</div>
                                                            <div class="col-md-3">V_LGR = Linguere</div>
                                                            <div class="col-md-3">V_MBA = Mbao</div>
                                                            <div class="col-md-3">V_KM = Keur Massar</div>
                                                            <div class="col-md-3">V_OSF = O.Foire</div>
                                                            <div class="col-md-3">V_SAC = Sacre Coeur</div>
                                                            <div class="col-md-3">V_ABATS = Abattage</div>
                                                        </div>
                                                    </div>
                                                </div>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                                
                                <div id="loading-indicator-cash-payment" class="text-center my-4" style="display: none;">
                                    <div class="spinner-border text-primary" role="status">
                                        <span class="visually-hidden">Chargement...</span>
                                    </div>
                                    <p>Traitement des données en cours...</p>
                                </div>
                                
                                <div class="row mt-4">
                                    <div class="col-md-12">
                                        <div class="d-flex justify-content-between align-items-center mb-3">
                                            <h5>Données Agrégées par Date et Point de Vente</h5>
                                            <div class="d-flex gap-2">
                                                <button class="btn btn-outline-success btn-sm" id="add-manual-payment" style="display: none;">
                                                    <i class="bi bi-plus-circle"></i> Ajouter un paiement
                                                </button>
                                                <button class="btn btn-outline-danger btn-sm" id="clear-cash-payment-data" style="display: none;">
                                                    <i class="bi bi-trash"></i> Effacer les données
                                                </button>
                                            </div>
                                        </div>
                                        
                                        <!-- START: Totals Section -->
                                        <div class="row mt-4">
                                            <div class="col-md-6 mb-3">
                                                <div class="card h-100">
                                                    <div class="card-header bg-light-success">
                                                        <h6 class="card-title mb-0">Total Encaissements (Période sélectionnée)</h6>
                                                    </div>
                                                    <div class="card-body">
                                                        <!-- Container for Point de Vente breakdown -->
                                                        <div id="total-positif-pdv-breakdown">
                                                            <!-- Breakdown will be inserted here by JS -->
                                                        </div>
                                                        <!-- End container -->
                                                        <p class="mb-1 mt-2">Autre(s): <strong class="float-end"><span id="total-positif-autres">0</span> FCFA</strong></p>
                                                        <hr class="my-1">
                                                        <p class="fw-bold mb-0">Total: <strong class="float-end"><span id="total-positif-global">0</span> FCFA</strong></p>
                                                    </div>
                                                </div>
                                            </div>
                                            <div class="col-md-6 mb-3">
                                                <div class="card h-100">
                                                    <div class="card-header bg-light-danger">
                                                        <h6 class="card-title mb-0">Total Retraits (Période sélectionnée)</h6>
                                                    </div>
                                                    <div class="card-body">
                                                         <p class="fw-bold mb-0">Total: <strong class="float-end"><span id="total-negatif-retraits">0</span> FCFA</strong></p>
                                                    </div>
                                                </div>
                                            </div>
                                        </div>
                                        <!-- END: Totals Section -->
                                        
                                        <div class="row mb-3 filter-section">
                                            <div class="col-md-3">
                                                <label for="month-filter-cash" class="form-label">Filtrer par mois</label>
                                                <input type="month" class="form-control" id="month-filter-cash" placeholder="Tous les mois">
                                            </div>
                                            <div class="col-md-3">
                                                <label for="date-filter-cash" class="form-label">Filtrer par date</label>
                                                <input type="text" class="form-control" id="date-filter-cash" placeholder="Toutes les dates">
                                            </div>
                                            <div class="col-md-3">
                                                <label for="point-vente-filter-cash" class="form-label">Filtrer par point de vente</label>
                                                <select class="form-select" id="point-vente-filter-cash">
                                                    <option value="">Tous les points de vente</option>
                                                    <!-- Options will be populated dynamically -->
                                                </select>
                                            </div>
                                            <div class="col-md-3 d-flex align-items-end">
                                                <div class="d-flex w-100 gap-2">
                                                    <button class="btn btn-outline-primary flex-grow-1" id="apply-filters-cash">
                                                        <i class="bi bi-funnel"></i> Appliquer les filtres
                                                    </button>
                                                    <div class="form-check align-self-center">
                                                        <input class="form-check-input" type="checkbox" id="auto-apply-filter" checked>
                                                        <label class="form-check-label small" for="auto-apply-filter">Auto</label>
                                                    </div>
                                                </div>
                                            </div>
                                        </div>
                                        
                                        <div class="table-responsive">
                                            <table id="cash-payment-table" class="table table-striped table-bordered">
                                                <thead>
                                                    <tr>
                                                        <th>Date</th>
                                                        <th>Point de Vente</th>
                                                        <th class="text-end">Montant Total</th>
                                                    </tr>
                                                </thead>
                                                <tbody id="cash-payment-table-body">
                                                    <!-- Les données agrégées seront ajoutées ici dynamiquement -->
                                                </tbody>
                                            </table>
                                        </div>
                                        
                                        <div id="no-cash-payment-data" class="alert alert-warning mt-3" style="display: none;">
                                            Aucune donnée de paiement n'est disponible. Veuillez importer des données.
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Modal pour l'ajout manuel de paiement -->
            <div class="modal fade" id="addManualPaymentModal" tabindex="-1" aria-labelledby="addManualPaymentModalLabel" aria-hidden="true">
                <div class="modal-dialog">
                    <div class="modal-content">
                        <div class="modal-header">
                            <h5 class="modal-title" id="addManualPaymentModalLabel">
                                <i class="bi bi-plus-circle"></i> Ajouter un paiement manuel
                            </h5>
                            <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
                        </div>
                        <div class="modal-body">
                            <form id="manualPaymentForm">
                                <div class="mb-3">
                                    <label for="manualPaymentDate" class="form-label">Date *</label>
                                    <input type="date" class="form-control" id="manualPaymentDate" required>
                                </div>
                                <div class="mb-3">
                                    <label for="manualPaymentPointVente" class="form-label">Point de Vente *</label>
                                    <select class="form-select" id="manualPaymentPointVente" required>
                                        <option value="">Sélectionner un point de vente</option>
                                        <!-- Options seront remplies dynamiquement -->
                                    </select>
                                </div>
                                <div class="mb-3">
                                    <label for="manualPaymentAmount" class="form-label">Montant (FCFA) *</label>
                                    <input type="number" class="form-control" id="manualPaymentAmount" step="0.01" required>
                                    <div class="form-text">Utilisez un montant négatif pour un retrait</div>
                                </div>
                                <div class="mb-3">
                                    <label for="manualPaymentReference" class="form-label">Référence</label>
                                    <input type="text" class="form-control" id="manualPaymentReference" placeholder="Référence du paiement (optionnel)">
                                </div>
                                <div class="mb-3">
                                    <label for="manualPaymentComment" class="form-label">Commentaire</label>
                                    <textarea class="form-control" id="manualPaymentComment" rows="3" placeholder="Commentaire ou motif de l'ajout manuel"></textarea>
                                </div>
                                
                                <!-- Mapping des références de paiement -->
                                <div class="alert alert-info" id="paymentRefMappingInfo" style="display: none;">
                                    <p class="mb-2"><strong>Mapping des références de paiement :</strong></p>
                                    <div class="row small">
                                        <div class="col-md-4">V_TB = Touba</div>
                                        <div class="col-md-4">V_DHR = Dahra</div>
                                        <div class="col-md-4">V_ALS = Aliou Sow</div>
                                        <div class="col-md-4">V_LGR = Linguere</div>
                                        <div class="col-md-4">V_MBA = Mbao</div>
                                        <div class="col-md-4">V_KM = Keur Massar</div>
                                        <div class="col-md-4">V_OSF = O.Foire</div>
                                        <div class="col-md-4">V_SAC = Sacre Coeur</div>
                                        <div class="col-md-4">V_ABATS = Abattage</div>
                                    </div>
                                </div>
                            </form>
                        </div>
                        <div class="modal-footer">
                            <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Annuler</button>
                            <button type="button" class="btn btn-success" id="saveManualPayment">
                                <i class="bi bi-save"></i> Sauvegarder
                            </button>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Section de réconciliation mensuelle -->
            <div id="reconciliation-mois-section" class="container-fluid mt-4 content-section" style="display: none;">
                <div class="row">
                    <div class="col-md-12">
                        <div class="card">
                            <div class="card-header d-flex justify-content-between align-items-center">
                                <h5 class="card-title mb-0">Réconciliation Stock / Ventes du mois</h5>
                                <span class="small text-muted" id="sync-status-reconciliation-mois"></span>
                            </div>
                            <div class="card-body">
                                <!-- Totaux mensuels -->
                                <div class="row mb-4">
                                    <div class="col-md-3">
                                        <div class="card text-white bg-primary h-100">
                                            <div class="card-body">
                                                <h5 class="card-title">Total Ventes Théoriques (Mois)</h5>
                                                <p class="card-text fs-4 fw-bold" id="total-ventes-theoriques-mois">0 FCFA</p>
                                            </div>
                                        </div>
                                    </div>
                                    <div class="col-md-3">
                                        <div class="card text-white bg-success h-100">
                                            <div class="card-body">
                                                <h5 class="card-title">Total Ventes Saisies (Mois)</h5>
                                                <p class="card-text fs-4 fw-bold" id="total-ventes-saisies-mois">0 FCFA</p>
                                            </div>
                                        </div>
                                    </div>
                                    <div class="col-md-3">
                                        <div class="card text-white bg-info h-100">
                                            <div class="card-body">
                                                <h5 class="card-title">Total Versements (Cash) (Mois)</h5>
                                                <p class="card-text fs-4 fw-bold" id="total-versements-mois">0 FCFA</p>
                                            </div>
                                        </div>
                                    </div>
                                    <div class="col-md-3">
                                         <div class="card text-dark bg-warning h-100">
                                             <div class="card-body">
                                                 <h5 class="card-title">Estimation Versements (Mois)</h5>
                                                 <p class="card-text fs-4 fw-bold" id="estimation-versements-mois">0 FCFA</p>
                                             </div>
                                         </div>
                                    </div>
                                </div>
                                <!-- Fin Totaux mensuels (et estimation) -->

                                <div class="row mb-3">
                                    <div class="col-md-3">
                                        <label for="mois-reconciliation" class="form-label">Mois</label>
                                        <select class="form-select" id="mois-reconciliation">
                                            <option value="01">Janvier</option>
                                            <option value="02">Février</option>
                                            <option value="03">Mars</option>
                                            <option value="04">Avril</option>
                                            <option value="05">Mai</option>
                                            <option value="06">Juin</option>
                                            <option value="07">Juillet</option>
                                            <option value="08">Août</option>
                                            <option value="09">Septembre</option>
                                            <option value="10">Octobre</option>
                                            <option value="11">Novembre</option>
                                            <option value="12">Décembre</option>
                                        </select>
                                    </div>
                                    <div class="col-md-3">
                                        <label for="annee-reconciliation" class="form-label">Année</label>
                                        <select class="form-select" id="annee-reconciliation">
                                            <option value="2023">2023</option>
                                            <option value="2024">2024</option>
                                            <option value="2025">2025</option>
                                        </select>
                                    </div>
                                    <div class="col-md-3">
                                        <label for="point-vente-filtre-mois" class="form-label">Point de Vente</label>
                                        <select class="form-select" id="point-vente-filtre-mois">
                                            <option value="">Tous les points de vente</option>
                                            <!-- Options will be populated dynamically -->
                                        </select>
                                    </div>
                                    <div class="col-md-3 d-flex align-items-end justify-content-end">
                                        <button class="btn btn-success" id="export-reconciliation-mois">
                                            <i class="fas fa-file-excel"></i> Export Excel
                                        </button>
                                    </div>
                                </div>
                                
                                <div id="loading-indicator-reconciliation-mois" class="text-center" style="display: none;">
                                    <div class="spinner-border text-primary" role="status">
                                        <span class="visually-hidden">Chargement...</span>
                                    </div>
                                    <p>Calcul en cours, veuillez patienter...</p>
                                </div>
                                
                                <div class="table-responsive">
                                    <table id="reconciliation-mois-table" class="table table-striped table-bordered">
                                        <thead>
                                            <tr>
                                                <th>Date</th>
                                                <th>Point de Vente</th>
                                                <th class="text-end">Stock Matin</th>
                                                <th class="text-end">Stock Soir</th>
                                                <th class="text-end">Transferts</th>
                                                <th class="text-end">Ventes Théoriques</th>
                                                <th class="text-end">Ventes Saisies</th>
                                                <th class="text-end">Écart</th>
                                                <th class="text-end">Montant Total Cash</th>
                                                <th class="text-end">Écart %</th>
                                                <th class="text-end">Ecart Cash</th>
                                                <th>Commentaire</th>
                                            </tr>
                                        </thead>
                                        <tbody>
                                            <!-- Données de réconciliation générées dynamiquement -->
                                        </tbody>
                                    </table>
                                </div>
                                
                                <!-- Conteneur pour les détails -->
                                <div id="debug-container-mois" class="mt-4" style="display: none;">
                                    <h5>Détails de la réconciliation mensuelle</h5>
                                    <div class="card">
                                        <div class="card-body">
                                            <div id="debug-title-mois" class="mb-3"></div>
                                            <div id="debug-formule-mois" class="mb-3"></div>
                                            <div id="debug-ecart-mois" class="mb-3"></div>
                                            <h6 class="mt-4">Détails des composantes</h6>
                                            <div id="debug-stock-section-mois" class="mt-3"></div>
                                            <div id="debug-ventes-section-mois" class="mt-3"></div>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Section Suivi Achat Boeuf -->
            <div id="suivi-achat-boeuf-section" class="container-fluid mt-4 content-section" style="display: none;">
                 <div class="card">
                     <div class="card-header">
                         <h5 class="card-title mb-0">Suivi des Achats de Bétail (Boeuf/Veau)</h5>
                     </div>
                     <div class="card-body">
                         <!-- Import Section -->
                         <div class="row mb-3">
                             <div class="col-md-6">
                                 <label for="csvFile" class="form-label">Importer un fichier CSV</label>
                                 <input type="file" class="form-control" id="csvFile" accept=".csv">
                                 <div class="form-text">Format: Mois;Date;Bete;Prix;Abats;Frais abatage;Nbr kg;Prix d'achat par kg</div>
                             </div>
                             <div class="col-md-3 d-flex align-items-end">
                                 <button type="button" class="btn btn-primary w-100" id="importBtn">Importer</button>
                             </div>
                         </div>
                         <hr>
                         <!-- Form Section -->
                         <form id="achatBoeufForm" class="mb-4">
                             <div class="row">
                                 <div class="col-md-3">
                                     <div class="mb-3">
                                         <label for="mois" class="form-label">Mois</label>
                                         <input type="text" class="form-control" id="mois" required>
                                     </div>
                                 </div>
                                 <div class="col-md-3">
                                     <div class="mb-3">
                                         <label for="date" class="form-label">Date</label>
                                         <input type="date" class="form-control" id="date" required>
                                     </div>
                                 </div>
                                 <div class="col-md-3">
                                     <div class="mb-3">
                                         <label for="bete" class="form-label">Bête</label>
                                         <select class="form-select" id="bete" required>
                                             <option value="boeuf">Boeuf</option>
                                             <option value="veau">Veau</option>
                                         </select>
                                     </div>
                                 </div>
                                 <div class="col-md-3">
                                     <div class="mb-3">
                                         <label for="prix" class="form-label">Prix</label>
                                         <input type="number" class="form-control" id="prix" min="0" required>
                                     </div>
                                 </div>
                             </div>
                             <div class="row">
                                 <div class="col-md-3">
                                     <div class="mb-3">
                                         <label for="abats" class="form-label">Abats</label>
                                         <input type="number" class="form-control" id="abats" min="0" required>
                                     </div>
                                 </div>
                                 <div class="col-md-3">
                                     <div class="mb-3">
                                         <label for="fraisAbattage" class="form-label">Frais Abattage</label>
                                         <input type="number" class="form-control" id="fraisAbattage" min="0" required>
                                     </div>
                                 </div>
                                 <div class="col-md-3">
                                     <div class="mb-3">
                                         <label for="nbrKg" class="form-label">Nombre de Kg</label>
                                         <input type="number" class="form-control" id="nbrKg" min="0" step="0.01" required>
                                     </div>
                                 </div>
                                 <div class="col-md-3">
                                     <div class="mb-3">
                                         <label for="prixAchatKg" class="form-label">Prix par Kg</label>
                                         <input type="number" class="form-control" id="prixAchatKg" min="0" step="0.01">
                                     </div>
                                 </div>
                             </div>
                             <div class="d-grid">
                                 <button type="submit" class="btn btn-primary">Enregistrer</button>
                             </div>
                         </form>
                         <hr>
                         <!-- Visualization Section -->
                         <div id="achat-boeuf-visualisation" class="mt-4">
                            <h5 class="mb-3">Visualisation de l'évolution des prix d'achat par Kg</h5>
                            <div class="row">
                                <div class="col-md-6">
                                    <div class="card">
                                        <div class="card-header">Boeuf</div>
                                        <div class="card-body">
                                            <canvas id="boeufPrixKgChart"></canvas>
                                        </div>
                                    </div>
                                </div>
                                <div class="col-md-6">
                                    <div class="card">
                                        <div class="card-header">Veau</div>
                                        <div class="card-body">
                                            <canvas id="veauPrixKgChart"></canvas>
                                        </div>
                                    </div>
                                </div>
                            </div>
                         </div>
                         <hr>
                         <!-- Statistics Section -->
                         <div id="achat-boeuf-statistiques" class="mt-4">
                            <h5 class="mb-3">Statistiques sur les prix d'achat par Kg</h5>
                            <div class="row">
                                <div class="col-md-6">
                                    <div class="card">
                                        <div class="card-header">Boeuf</div>
                                        <div class="card-body">
                                            <p>Moyenne: <span id="boeuf-mean">N/A</span> FCFA/kg</p>
                                            <p>Médiane: <span id="boeuf-median">N/A</span> FCFA/kg</p>
                                            <p>Écart-type: <span id="boeuf-stddev">N/A</span> FCFA/kg</p>
                                        </div>
                                    </div>
                                </div>
                                <div class="col-md-6">
                                    <div class="card">
                                        <div class="card-header">Veau</div>
                                        <div class="card-body">
                                            <p>Moyenne: <span id="veau-mean">N/A</span> FCFA/kg</p>
                                            <p>Médiane: <span id="veau-median">N/A</span> FCFA/kg</p>
                                            <p>Écart-type: <span id="veau-stddev">N/A</span> FCFA/kg</p>
                                        </div>
                                    </div>
                                </div>
                            </div>
                         </div>
                         <hr>
                         <!-- Statistiques détaillées pour la période -->
                         <div id="achat-boeuf-statistiques-periode" class="mt-4">
                            <h5 class="mb-3">Statistiques détaillées pour la période</h5>
                            <div class="row">
                                <div class="col-md-6">
                                    <div class="card">
                                        <div class="card-header">Nombre de bêtes</div>
                                        <div class="card-body">
                                            <p>Bœufs: <span id="nombre-boeufs">0</span></p>
                                            <p>Veaux: <span id="nombre-veaux">0</span></p>
                                            <p><strong>Total: <span id="nombre-total">0</span></strong></p>
                                        </div>
                                    </div>
                                </div>
                                <div class="col-md-6">
                                    <div class="card">
                                        <div class="card-header">Poids</div>
                                        <div class="card-body">
                                            <p>Poids total vendu: <span id="poids-total">0</span> kg</p>
                                            <p>Poids moyen par bête: <span id="poids-moyen">0</span> kg</p>
                                            <p>Poids moyen bœuf: <span id="poids-moyen-boeuf">0</span> kg</p>
                                            <p>Poids moyen veau: <span id="poids-moyen-veau">0</span> kg</p>
                                        </div>
                                    </div>
                                </div>
                            </div>
                            <div class="row mt-3">
                                <div class="col-md-6">
                                    <div class="card">
                                        <div class="card-header">Prix totaux</div>
                                        <div class="card-body">
                                            <p>Prix total des abats: <span id="prix-total-abats">0</span> FCFA</p>
                                            <p>Frais d'abattage total: <span id="frais-abattage-total">0</span> FCFA</p>
                                            <p><strong>Prix total d'achat: <span id="prix-total-achat">0</span> FCFA</strong></p>
                                        </div>
                                    </div>
                                </div>
                                <div class="col-md-6">
                                    <div class="card">
                                        <div class="card-header">Prix moyens par bête</div>
                                        <div class="card-body">
                                            <p>Prix moyen d'un bœuf: <span id="prix-moyen-boeuf">0</span> FCFA</p>
                                            <p>Prix moyen d'un veau: <span id="prix-moyen-veau">0</span> FCFA</p>
                                            <p>Prix moyen global: <span id="prix-moyen-global">0</span> FCFA</p>
                                        </div>
                                    </div>
                                </div>
                            </div>
                         </div>
                         <!-- Date Filter Section -->
                         <div class="row mb-3 align-items-end">
                             <div class="col-md-3">
                                 <label for="achat-date-debut" class="form-label">Date de début</label>
                                 <input type="text" class="form-control" id="achat-date-debut" placeholder="Date début">
                             </div>
                             <div class="col-md-3">
                                 <label for="achat-date-fin" class="form-label">Date de fin</label>
                                 <input type="text" class="form-control" id="achat-date-fin" placeholder="Date fin">
                             </div>
                             <div class="col-md-6 d-flex align-items-end">
                                 <button class="btn btn-success" id="export-achat-boeuf-excel">
                                     <i class="bi bi-file-earmark-excel"></i> Export Excel
                                 </button>
                             </div>
                         </div>
                         <!-- Table Section -->
                         <div class="table-responsive">
                             <table id="achat-boeuf-table" class="table table-striped table-bordered table-hover">
                                 <thead>
                                     <tr>
                                         <th>Mois</th>
                                         <th>Date</th>
                                         <th>Bête</th>
                                         <th class="text-end">Prix</th>
                                         <th class="text-end">Abats</th>
                                         <th class="text-end">Frais Abattage</th>
                                         <th class="text-end">Nbr kg</th>
                                         <th class="text-end">Prix Achat/kg</th>
                                         <th>Actions</th>
                                         <th>Status</th>
                                     </tr>
                                 </thead>
                                 <tbody id="achat-boeuf-table-body">
                                     <!-- Rows will be populated by JS -->
                                 </tbody>
                             </table>
                         </div>
                         <!-- Action Buttons -->
                         <div class="mt-3">
                             <button class="btn btn-secondary" id="add-achat-boeuf-row">
                                 <i class="fas fa-plus"></i> Ajouter une ligne
                             </button>
                             <button class="btn btn-success ms-2" id="save-achat-boeuf">
                                 <i class="fas fa-save"></i> Sauvegarder les achats
                             </button>
                         </div>
                     </div>
                 </div>
            </div>
            <!-- End Section Suivi Achat Boeuf -->

            <!-- Estimation Section -->
            <div id="estimation-section" class="section-content" style="display: none;">
                <div class="card">
                    <div class="card-header">
                        <h5 class="card-title mb-0">Estimation des Ventes</h5>
                    </div>
                    <div class="card-body">
                        <form id="estimation-form">
                            <!-- En-tête avec Date, Point de Vente et Paramètres -->
                            <div class="row mb-4">
                                <div class="col-md-5">
                                    <label for="estimation-date" class="form-label">Date</label>
                                    <input type="text" class="form-control" id="estimation-date" required>
                                </div>
                                <div class="col-md-5">
                                    <label for="estimation-point-vente" class="form-label">Point de Vente</label>
                                    <select class="form-select" id="estimation-point-vente" required>
                                        <option value="">Sélectionner un point de vente</option>
                                    </select>
                                </div>
                                <div class="col-md-2 d-flex align-items-end">
                                    <button type="button" class="btn btn-outline-secondary w-100" id="weight-params-btn" title="Configurer les paramètres de poids">
                                        <i class="bi bi-gear"></i> Paramètres poids
                                    </button>
                                </div>
                            </div>

                            <!-- Bouton pour afficher/masquer tous les produits -->
                            <div class="row mb-3">
                                <div class="col-12">
                                    <button type="button" class="btn btn-outline-info btn-sm" id="show-all-products-btn" data-show-all="false" onclick="toggleProductsDisplay()" title="Afficher tous les produits">
                                        📊 Afficher Tous
                                    </button>
                                    <small class="text-muted ms-2">Par défaut: Boeuf, Veau, Agneau, Foie, Yell, Poulet</small>
                                </div>
                            </div>

                            <!-- Tableau des produits -->
                            <div class="table-responsive">
                                <table class="table table-striped table-bordered" id="estimation-products-table">
                                    <thead class="table-primary">
                                        <tr>
                                            <th class="text-center">Produit</th>
                                            <th class="text-center">Estimation</th>
                                            <th class="text-center">Pré-commande</th>
                                            <th class="text-center">Commentaire</th>
                                        </tr>
                                    </thead>
                                    <tbody id="estimation-products-tbody">
                                        <!-- Les produits seront chargés dynamiquement ici -->
                                    </tbody>
                                </table>
                            </div>

                            <div class="row mt-3">
                                <div class="col-12">
                                    <button type="submit" class="btn btn-primary btn-lg">
                                        <i class="bi bi-check-circle"></i> Enregistrer l'estimation
                                    </button>
                                </div>
                            </div>
                        </form>
                    </div>
                </div>
                <!-- Table for displaying estimations -->
                <div class="card mt-4">
                    <div class="card-header d-flex justify-content-between align-items-center">
                        <h5 class="card-title mb-0">Historique des Estimations</h5>
                        <div class="d-flex align-items-center gap-3">
                            <button id="toggle-stock-columns" class="btn btn-outline-info btn-sm" title="Afficher/Masquer les colonnes de stock">
                                <i class="bi bi-bar-chart"></i> Afficher Stocks
                            </button>
                            <button class="btn btn-success btn-sm" onclick="exportEstimationsToExcel()" title="Exporter les estimations en Excel">
                                <i class="bi bi-file-earmark-excel"></i> Export Excel
                            </button>
                        <div class="performance-slider-wrapper" style="width: 300px;">
                            <div class="performance-slider-container">
                                <label class="performance-threshold-label">Seuil de performance:</label>
                                <div class="d-flex align-items-center">
                                    <div style="flex-grow: 1; position: relative; padding: 0 10px;">
                                        <div class="performance-slider-track">
                                            <div class="performance-slider-fill" id="performance-slider-fill"></div>
                                        </div>
                                        <input type="range" class="performance-slider" id="performance-threshold" min="0" max="100" value="5">
                                        <div class="threshold-handle-indicator" style="position: absolute; top: -15px; text-align: center; font-size: 11px; white-space: nowrap; left: 50%; transform: translateX(-50%); color: #666;">
                                            ← Glisser pour ajuster →
                                        </div>
                                    </div>
                                    <div class="threshold-value-display" id="threshold-value">5%</div>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                    
                    <!-- Filter controls for the estimation history table -->
                    <div class="card-body border-bottom pb-2">
                        <div class="row align-items-center">
                            <div class="col-md-2">
                                <label class="form-label mb-1"><strong>Filtres:</strong></label>
                            </div>
                            <div class="col-md-3">
                                <div class="form-group mb-2">
                                    <label for="filter-point-vente" class="form-label">Point de vente:</label>
                                    <select id="filter-point-vente" class="form-select form-select-sm">
                                        <option value="">Tous les points de vente</option>
                                        <!-- Options will be populated by JavaScript -->
                                    </select>
                                </div>
                            </div>
                            <div class="col-md-3">
                                <div class="form-group mb-2">
                                    <label for="filter-categorie" class="form-label">Catégorie:</label>
                                    <select id="filter-categorie" class="form-select form-select-sm">
                                        <option value="">Toutes les catégories</option>
                                        <!-- Options will be populated by JavaScript -->
                                    </select>
                                </div>
                            </div>
                            <div class="col-md-3">
                                <div class="form-group mb-2">
                                    <label for="filter-date" class="form-label">Date:</label>
                                    <input type="text" id="filter-date" class="form-control form-control-sm" placeholder="Sélectionner une date">
                                </div>
                            </div>
                            <div class="col-md-1 d-flex align-items-end">
                                <button id="reset-filters" class="btn btn-sm btn-outline-secondary mb-2">
                                    <i class="bi bi-x-circle"></i> Réinitialiser
                                </button>
                            </div>
                        </div>
                    </div>
                    
                    <div class="card-body">
                        <div class="table-responsive">
                            <table class="table table-striped table-bordered table-hover">
                                <thead>
                                    <tr>
                                        <th class="text-center">
                                            <input type="checkbox" id="select-all-estimations" title="Sélectionner tout">
                                        </th>
                                        <th class="text-center">Date</th>
                                        <th class="text-center">Point de Vente</th>
                                        <th class="text-center">Catégorie</th>
                                        <th class="text-center stock-column" style="display: none;">Stock Matin</th>
                                        <th class="text-center stock-column" style="display: none;">Transfert</th>
                                        <th class="text-center stock-column" style="display: none;">Stock Soir</th>
                                        <th class="text-center"><strong>Estimation</strong></th>
                                        <th class="text-center">Pré-commande</th>
                                        <th class="text-center"><strong>Ventes théo.</strong></th>
                                        <th class="text-center">Différence</th>
                                        <th class="text-center">Différence (%)</th>
                                        <th class="text-center">Status</th>
                                        <th class="text-center">Commentaire</th>
                                        <th class="text-center">Actions</th>
                                    </tr>
                                </thead>
                                <tbody id="estimations-table-body">
                                </tbody>
                            </table>
                        </div>
                    </div>
                </div>
            </div>
            <!-- End Estimation Section -->

        </div>
    </div>

    <!-- Scripts externes -->
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0-alpha1/dist/js/bootstrap.bundle.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/flatpickr@4.6.13/dist/flatpickr.min.js"></script>
    <script src="https://npmcdn.com/flatpickr/dist/l10n/fr.js"></script> <!-- Added French locale -->
    <script src="https://cdn.jsdelivr.net/npm/xlsx@0.18.5/dist/xlsx.full.min.js"></script>
    
    <!-- Scripts locaux -->
    <script src="data/by-date/produits.js"></script>
    <script src="data/by-date/produitsInventaire.js"></script>
    <script src="reconciliationManager.js"></script>
    <script src="cash-payment-function.js"></script>
    <script src="script.js"></script>
    <script src="cash-payment.js"></script>
    <script src="transfert.js"></script>
    <script src="public/js/suiviAchatBoeuf.js"></script>
    <script src="public/js/estimation.js"></script>
    <script src="stock-export.js"></script>

    <!-- Script pour corriger la visibilité des sections -->
    <script src="fix-section-visibility.js"></script>

    <!-- Script pour forcer l'affichage de la section estimation -->
    <script>
        // Force display of the estimation section when page loads
        document.addEventListener('DOMContentLoaded', function() {
            console.log('Force showing estimation section from inline script');
            
            // Get the estimation section element
            var estimationSection = document.getElementById('estimation-section');
            if (estimationSection) {
                // Make sure it's visible
                estimationSection.style.display = 'block';
                
                // Set a timeout to check again after a short delay
                setTimeout(function() {
                    if (window.getComputedStyle(estimationSection).display === 'none') {
                        console.log('Section was hidden, forcing display again');
                        estimationSection.style.display = 'block';
                    }
                }, 500);
            }
            
            // Initialize flatpickr manually without locale if needed
            var dateInput = document.getElementById('estimation-date');
            if (dateInput && window.flatpickr && typeof flatpickr === 'function') {
                try {
                    console.log('Manually initializing flatpickr');
                    flatpickr(dateInput, {
                        dateFormat: 'd-m-Y',
                        defaultDate: new Date(),
                        locale: null // Force null locale to avoid errors
                    });
                } catch (e) {
                    console.error('Error initializing flatpickr:', e);
                }
            }
            
            // Force load latest estimation after a delay
            setTimeout(function() {
                if (typeof loadLatestEstimation === 'function') {
                    console.log('Force loading latest estimation from inline script');
                    loadLatestEstimation();
                }
            }, 800);
        });
    </script>
    
    <!-- Script pour gérer l'accès au chat Relevance AI -->
    <script>
        // Fonction pour vérifier l'accès au chat
        function checkChatAccess() {
            // Vérifie si l'utilisateur actuel existe dans la variable globale
            if (window.currentUser) {
                // Vérifie si l'utilisateur a la permission d'accéder au chat
                if (!window.currentUser.canAccessChat) {
                    // Si l'utilisateur n'est pas autorisé, on observe le DOM pour détecter quand le chat est ajouté
                    const observer = new MutationObserver(function(mutations) {
                        mutations.forEach(function(mutation) {
                            mutation.addedNodes.forEach(function(node) {
                                // Si le noeud ajouté est un élément HTML et a une relation avec le chat
                                if (node.nodeType === 1 && (
                                    node.id && node.id.includes('relevance') || 
                                    node.className && node.className.includes('relevance')
                                )) {
                                    // Cache l'élément du chat
                                    node.style.display = 'none';
                                }
                            });
                        });
                    });
                    
                    // Démarrer l'observation du document
                    observer.observe(document.body, { childList: true, subtree: true });
                    
                    // Supprime également le script du chat après un court délai
                    setTimeout(function() {
                        const chatScript = document.querySelector('script[data-relevanceai-share-id]');
                        if (chatScript) {
                            chatScript.remove();
                        }
                    }, 100);
                    
                    console.log('Chat Relevance AI désactivé pour cet utilisateur');
                    return false;
                } else {
                    console.log('Chat Relevance AI activé pour cet utilisateur');
                    return true;
                }
            } else {
                // Si l'utilisateur n'est pas encore chargé, on réessaye après un délai
                setTimeout(checkChatAccess, 1000);
                return false;
            }
        }
        
        // Vérifier l'accès au chat quand le DOM est chargé
        document.addEventListener('DOMContentLoaded', function() {
            // Attendre que la variable currentUser soit définie
            const checkInterval = setInterval(function() {
                if (window.currentUser) {
                    clearInterval(checkInterval);
                    checkChatAccess();
                }
            }, 500);
            
            // Arrêter de vérifier après 10 secondes pour éviter une boucle infinie
            setTimeout(function() {
                clearInterval(checkInterval);
            }, 10000);
        });
    </script>
    
    <script defer data-relevanceai-share-id="d7b62b/454efacc47da-463b-877a-66e43c7b454a/ebb0f674-400d-4843-b6b9-b9c327246419" src="https://app.relevanceai.com/embed/chat-bubble.js" data-share-styles="starting_message_prompts=Lancer+un+rapport+pour+aujourd%27hui&starting_message_prompts=&hide_tool_steps=false&hide_file_uploads=false&hide_conversation_list=false&bubble_style=agent&primary_color=%23685FFF&bubble_icon=pd%2Fchat&input_placeholder_text=Type+your+message...&hide_logo=true&hide_description=false" ></script>
    
    <!-- Overlay de chargement -->
    <div id="loading-overlay" class="loading-overlay">
        <div class="spinner-container">
            <div class="spinner"></div>
            <div class="spinner-text">Enregistrement en cours...</div>
        </div>
    </div>

    <!-- Modal de validation de l'estimation -->
    <div class="modal fade" id="estimationValidationModal" tabindex="-1" aria-labelledby="estimationValidationModalLabel" aria-hidden="true">
        <div class="modal-dialog modal-lg">
            <div class="modal-content">
                <div class="modal-header bg-primary text-white">
                    <h5 class="modal-title" id="estimationValidationModalLabel">
                        <i class="bi bi-check-circle"></i> Confirmer l'estimation
                    </h5>
                    <button type="button" class="btn-close btn-close-white" data-bs-dismiss="modal" aria-label="Close"></button>
                </div>
                <div class="modal-body">
                    <div class="row mb-3">
                        <div class="col-md-6">
                            <strong>Date:</strong> <span id="validation-date"></span>
                        </div>
                        <div class="col-md-6">
                            <strong>Point de Vente:</strong> <span id="validation-point-vente"></span>
                        </div>
                    </div>
                    
                    <h6 class="mb-3">Produits à enregistrer:</h6>
                    
                    <div class="table-responsive">
                        <table class="table table-sm table-striped">
                            <thead class="table-secondary">
                                <tr>
                                    <th>Produit</th>
                                    <th class="text-center">Estimation (kg)</th>
                                    <th class="text-center">Pré-commande (kg)</th>
                                    <th class="text-center">Commentaire</th>
                                </tr>
                            </thead>
                            <tbody id="validation-products-tbody">
                                <!-- Les produits avec valeurs > 0 seront affichés ici -->
                            </tbody>
                        </table>
                    </div>
                    
                    <div class="alert alert-info">
                        <i class="bi bi-info-circle"></i>
                        <strong>Total: <span id="validation-products-count">0</span> produit(s)</strong> seront enregistrés
                    </div>
                </div>
                <div class="modal-footer">
                    <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">
                        <i class="bi bi-x-circle"></i> Annuler
                    </button>
                    <button type="button" class="btn btn-primary" id="confirm-estimation-btn">
                        <i class="bi bi-check-circle"></i> Confirmer
                    </button>
                </div>
            </div>
        </div>
    </div>

    <!-- Modal des paramètres de poids -->
    <div class="modal fade" id="weightParamsModal" tabindex="-1" aria-labelledby="weightParamsModalLabel" aria-hidden="true">
        <div class="modal-dialog modal-lg">
            <div class="modal-content">
                <div class="modal-header bg-secondary text-white">
                    <h5 class="modal-title" id="weightParamsModalLabel">
                        <i class="bi bi-gear"></i> Paramètres de poids
                    </h5>
                    <button type="button" class="btn-close btn-close-white" data-bs-dismiss="modal" aria-label="Close"></button>
                </div>
                <div class="modal-body">
                    <div class="row mb-3">
                        <div class="col-md-12">
                            <strong>Date:</strong> <span id="weight-params-date"></span>
                        </div>
                    </div>
                    
                    <h6 class="mb-3">Poids par unité (kg) :</h6>
                    
                    <div class="row mb-3">
                        <div class="col-md-6">
                            <label for="weight-boeuf" class="form-label">Bœuf :</label>
                            <div class="input-group">
                                <input type="number" class="form-control" id="weight-boeuf" step="0.1" min="0" value="150">
                                <span class="input-group-text">kg/unité</span>
                            </div>
                        </div>
                        <div class="col-md-6">
                            <label for="weight-veau" class="form-label">Veau :</label>
                            <div class="input-group">
                                <input type="number" class="form-control" id="weight-veau" step="0.1" min="0" value="110">
                                <span class="input-group-text">kg/unité</span>
                            </div>
                        </div>
                    </div>
                    
                    <div class="row mb-3">
                        <div class="col-md-6">
                            <label for="weight-agneau" class="form-label">Agneau :</label>
                            <div class="input-group">
                                <input type="number" class="form-control" id="weight-agneau" step="0.1" min="0" value="10">
                                <span class="input-group-text">kg/unité</span>
                            </div>
                        </div>
                        <div class="col-md-6">
                            <label for="weight-poulet" class="form-label">Poulet :</label>
                            <div class="input-group">
                                <input type="number" class="form-control" id="weight-poulet" step="0.1" min="0" value="1">
                                <span class="input-group-text">kg/unité</span>
                            </div>
                        </div>
                    </div>
                    
                    <div class="row mb-3">
                        <div class="col-md-6">
                            <label for="weight-default" class="form-label">Autres produits (par défaut) :</label>
                            <div class="input-group">
                                <input type="number" class="form-control" id="weight-default" step="0.1" min="0" value="1">
                                <span class="input-group-text">kg/unité</span>
                            </div>
                        </div>
                    </div>
                    
                    <div class="alert alert-info">
                        <i class="bi bi-info-circle"></i>
                        <strong>Note :</strong> Ces paramètres seront sauvegardés pour la date sélectionnée et utilisés pour les conversions unité → kg.
                    </div>
                </div>
                <div class="modal-footer">
                    <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">
                        <i class="bi bi-x-circle"></i> Annuler
                    </button>
                    <button type="button" class="btn btn-primary" id="save-weight-params-btn">
                        <i class="bi bi-check-circle"></i> Sauvegarder
                    </button>
                </div>
            </div>
        </div>
    </div>

    <!-- Modal de conversion pré-commande vers vente -->
    <div class="modal fade" id="conversionModal" tabindex="-1" aria-labelledby="conversionModalLabel" aria-hidden="true">
        <div class="modal-dialog">
            <div class="modal-content">
                <div class="modal-header">
                    <h5 class="modal-title" id="conversionModalLabel">
                        <i class="bi bi-arrow-right-circle"></i> Convertir en vente réelle
                    </h5>
                    <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
                </div>
                <div class="modal-body">
                    <div class="alert alert-info">
                        <i class="bi bi-info-circle"></i>
                        Cette action va convertir la pré-commande en vente réelle. La pré-commande sera supprimée et une nouvelle vente sera créée.
                    </div>
                    
                    <form id="conversion-form">
                        <div class="mb-3">
                            <label for="conversion-date-vente" class="form-label">Date de la vente *</label>
                            <input type="text" class="form-control" id="conversion-date-vente" required>
                            <div class="form-text">Date à laquelle la vente a été réellement effectuée</div>
                        </div>
                        
                        <div class="mb-3">
                            <label for="conversion-point-vente" class="form-label">Point de vente de destination *</label>
                            <select class="form-select" id="conversion-point-vente" required>
                                <option value="">Sélectionner un point de vente</option>
                            </select>
                            <div class="form-text">Point de vente où la vente a été réellement effectuée</div>
                        </div>
                        
                        <!-- Informations de la pré-commande à convertir -->
                        <div class="card bg-light mt-3">
                            <div class="card-header">
                                <h6 class="mb-0">Informations de la pré-commande</h6>
                            </div>
                            <div class="card-body">
                                <div class="row">
                                    <div class="col-6">
                                        <strong>Client:</strong> <span id="conversion-info-client"></span>
                                    </div>
                                    <div class="col-6">
                                        <strong>Montant:</strong> <span id="conversion-info-montant"></span>
                                    </div>
                                </div>
                                <div class="row mt-2">
                                    <div class="col-6">
                                        <strong>Produit:</strong> <span id="conversion-info-produit"></span>
                                    </div>
                                    <div class="col-6">
                                        <strong>Quantité:</strong> <span id="conversion-info-quantite"></span>
                                    </div>
                                </div>
                                <div class="row mt-2">
                                    <div class="col-12">
                                        <strong>Commentaire:</strong> <span id="conversion-info-commentaire"></span>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </form>
                </div>
                <div class="modal-footer">
                    <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Annuler</button>
                    <button type="button" class="btn btn-success" id="confirmer-conversion">
                        <i class="bi bi-check-circle"></i> Confirmer la conversion
                    </button>
                </div>
            </div>
        </div>
    </div>

    <!-- Modal d'annulation pré-commande -->
    <div class="modal fade" id="cancelPrecommandeModal" tabindex="-1" aria-labelledby="cancelPrecommandeModalLabel" aria-hidden="true">
        <div class="modal-dialog">
            <div class="modal-content">
                <div class="modal-header bg-danger text-white">
                    <h5 class="modal-title" id="cancelPrecommandeModalLabel">
                        <i class="bi bi-x-circle"></i> Annuler Pré-commande
                    </h5>
                    <button type="button" class="btn-close btn-close-white" data-bs-dismiss="modal" aria-label="Close"></button>
                </div>
                <div class="modal-body">
                    <div class="alert alert-warning">
                        <i class="bi bi-exclamation-triangle"></i>
                        <strong>Attention :</strong> Cette action annulera définitivement la pré-commande.
                    </div>
                    <form id="cancelPrecommandeForm">
                        <div class="mb-3">
                            <label for="cancel-commentaire" class="form-label">Raison de l'annulation *</label>
                            <textarea class="form-control" id="cancel-commentaire" rows="3" required placeholder="Expliquez pourquoi cette pré-commande est annulée..."></textarea>
                        </div>
                    </form>
                </div>
                <div class="modal-footer">
                    <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Annuler</button>
                    <button type="button" class="btn btn-danger" id="confirmer-cancel">
                        <i class="bi bi-x-circle"></i> Confirmer l'annulation
                    </button>
                </div>
            </div>
        </div>
    </div>

    <!-- Modal d'archivage pré-commande -->
    <div class="modal fade" id="archivePrecommandeModal" tabindex="-1" aria-labelledby="archivePrecommandeModalLabel" aria-hidden="true">
        <div class="modal-dialog">
            <div class="modal-content">
                <div class="modal-header bg-secondary text-white">
                    <h5 class="modal-title" id="archivePrecommandeModalLabel">
                        <i class="bi bi-archive"></i> Archiver Pré-commande
                    </h5>
                    <button type="button" class="btn-close btn-close-white" data-bs-dismiss="modal" aria-label="Close"></button>
                </div>
                <div class="modal-body">
                    <div class="alert alert-info">
                        <i class="bi bi-info-circle"></i>
                        <strong>Information :</strong> Cette action archivera la pré-commande pour référence future.
                    </div>
                    <form id="archivePrecommandeForm">
                        <div class="mb-3">
                            <label for="archive-commentaire" class="form-label">Raison de l'archivage *</label>
                            <textarea class="form-control" id="archive-commentaire" rows="3" required placeholder="Expliquez pourquoi cette pré-commande est archivée..."></textarea>
                        </div>
                    </form>
                </div>
                <div class="modal-footer">
                    <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Annuler</button>
                    <button type="button" class="btn btn-secondary" id="confirmer-archive">
                        <i class="bi bi-archive"></i> Confirmer l'archivage
                    </button>
                </div>
            </div>
        </div>
    </div>

    <!-- Modal de modification pré-commande -->
    <div class="modal fade" id="editPrecommandeModal" tabindex="-1" aria-labelledby="editPrecommandeModalLabel" aria-hidden="true">
        <div class="modal-dialog modal-lg">
            <div class="modal-content">
                <div class="modal-header bg-primary text-white">
                    <h5 class="modal-title" id="editPrecommandeModalLabel">
                        <i class="bi bi-pencil"></i> Modifier Pré-commande
                    </h5>
                    <button type="button" class="btn-close btn-close-white" data-bs-dismiss="modal" aria-label="Close"></button>
                </div>
                <div class="modal-body">
                    <form id="editPrecommandeForm">
                        <div class="row">
                            <div class="col-md-6">
                                <div class="mb-3">
                                    <label for="edit-mois" class="form-label">Mois *</label>
                                    <input type="text" class="form-control" id="edit-mois" required>
                                </div>
                            </div>
                            <div class="col-md-6">
                                <div class="mb-3">
                                    <label for="edit-semaine" class="form-label">Semaine *</label>
                                    <input type="text" class="form-control" id="edit-semaine" required>
                                </div>
                            </div>
                        </div>
                        
                        <div class="row">
                            <div class="col-md-6">
                                <div class="mb-3">
                                    <label for="edit-date-enregistrement" class="form-label">Date Enregistrement *</label>
                                    <input type="date" class="form-control" id="edit-date-enregistrement" required>
                                </div>
                            </div>
                            <div class="col-md-6">
                                <div class="mb-3">
                                    <label for="edit-date-reception" class="form-label">Date Réception *</label>
                                    <input type="date" class="form-control" id="edit-date-reception" required>
                                </div>
                            </div>
                        </div>
                        
                        <div class="row">
                            <div class="col-md-6">
                                <div class="mb-3">
                                    <label for="edit-point-vente" class="form-label">Point de Vente *</label>
                                    <select class="form-select" id="edit-point-vente" required>
                                        <option value="">Sélectionner...</option>
                                    </select>
                                </div>
                            </div>
                            <div class="col-md-6">
                                <div class="mb-3">
                                    <label for="edit-preparation" class="form-label">Préparation *</label>
                                    <input type="text" class="form-control" id="edit-preparation" required>
                                </div>
                            </div>
                        </div>
                        
                        <div class="row">
                            <div class="col-md-6">
                                <div class="mb-3">
                                    <label for="edit-categorie" class="form-label">Catégorie *</label>
                                    <select class="form-select" id="edit-categorie" required>
                                        <option value="">Sélectionner...</option>
                                    </select>
                                </div>
                            </div>
                            <div class="col-md-6">
                                <div class="mb-3">
                                    <label for="edit-produit" class="form-label">Produit *</label>
                                    <select class="form-select" id="edit-produit" required>
                                        <option value="">Sélectionner...</option>
                                    </select>
                                </div>
                            </div>
                        </div>
                        
                        <div class="row">
                            <div class="col-md-4">
                                <div class="mb-3">
                                    <label for="edit-prix-unit" class="form-label">Prix Unitaire *</label>
                                    <input type="number" class="form-control" id="edit-prix-unit" step="0.01" required>
                                </div>
                            </div>
                            <div class="col-md-4">
                                <div class="mb-3">
                                    <label for="edit-nombre" class="form-label">Quantité *</label>
                                    <input type="number" class="form-control" id="edit-nombre" step="0.001" required>
                                </div>
                            </div>
                            <div class="col-md-4">
                                <div class="mb-3">
                                    <label for="edit-montant" class="form-label">Montant *</label>
                                    <input type="number" class="form-control" id="edit-montant" step="0.01" required>
                                </div>
                            </div>
                        </div>
                        
                        <div class="row">
                            <div class="col-md-4">
                                <div class="mb-3">
                                    <label for="edit-nom-client" class="form-label">Nom Client</label>
                                    <input type="text" class="form-control" id="edit-nom-client">
                                </div>
                            </div>
                            <div class="col-md-4">
                                <div class="mb-3">
                                    <label for="edit-numero-client" class="form-label">Numéro Client</label>
                                    <input type="text" class="form-control" id="edit-numero-client">
                                </div>
                            </div>
                            <div class="col-md-4">
                                <div class="mb-3">
                                    <label for="edit-adresse-client" class="form-label">Adresse Client</label>
                                    <input type="text" class="form-control" id="edit-adresse-client">
                                </div>
                            </div>
                        </div>
                        
                        <div class="row">
                            <div class="col-md-6">
                                <div class="mb-3">
                                    <label for="edit-commentaire" class="form-label">Commentaire</label>
                                    <textarea class="form-control" id="edit-commentaire" rows="2"></textarea>
                                </div>
                            </div>
                            <div class="col-md-6">
                                <div class="mb-3">
                                    <label for="edit-label" class="form-label">Label</label>
                                    <input type="text" class="form-control" id="edit-label">
                                </div>
                            </div>
                        </div>
                    </form>
                </div>
                <div class="modal-footer">
                    <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Annuler</button>
                    <button type="button" class="btn btn-primary" id="confirmer-modification">
                        <i class="bi bi-check-circle"></i> Confirmer la modification
                    </button>
                </div>
            </div>
        </div>
    </div>

      
</body>
</html>